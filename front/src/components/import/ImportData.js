import AppHelper from 'helpers/AppHelper';
import AuthHelper from 'helpers/AuthHelper';
import DefaultHelper from 'helpers/DefaultHelper';
import { BaseData }  from 'ap-react-bootstrap'

/* This class was auto-generated by the JavaScriptWriter */
class ImportData extends BaseData {

	register(obj) {
		super.register(obj)

		this.obj.onClickImport = this.onClickImport.bind(this)

		this.obj.state = {
			upload: "Upload your file"
		}
	}

	unregister() {

	}

	onChange() {
		this.setState({upload: this.obj.fileInput.files[0].name})
	}

	onClickImport() {
		var f = this.obj.fileInput.files[0]; 

	    if (f) {
	      var r = new FileReader();
	      r.onload = function(e) { 
		    var contents = e.target.result;
		    DefaultHelper.postUserImport({
		    	data: contents, 
		    	userId: AuthHelper.getEntityId()
		    }).then(
		    	AppHelper.navigate("/monsters")
		    )
	      }
	      r.readAsText(f);
	    } else { 
	      console.log("Failed to load file");
	    }
	}


}
var ImportObj = new ImportData();
export default ImportObj;
